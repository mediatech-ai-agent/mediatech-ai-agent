@import 'tailwindcss';
@tailwind utilities;

/* 폰트 일관성을 위한 전역 설정 */
* {
  /* 폰트 렌더링 최적화 */
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizeLegibility;
}

html {
  /* Pretendard 1순위, Noto Sans KR 2순위 폰트 설정 */
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", -apple-system, BlinkMacSystemFont, 
               "Apple SD Gothic Neo", "Malgun Gothic", "Segoe UI", Roboto, "Helvetica Neue", 
               Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", 
               "Noto Color Emoji";
  
  /* 폰트 크기 및 줄 높이 정규화 */
  font-size: 16px;
  line-height: 1.6; /* Pretendard에 최적화된 줄 높이 */
  
  /* 텍스트 품질 향상 */
  text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  
  /* Pretendard Variable 폰트 최적화 */
  font-variation-settings: "wght" 400;
}

body {
  /* 폰트 상속 및 기본 설정 */
  font-family: inherit;
  font-weight: 400;
  font-style: normal;
  
  /* 텍스트 선택 색상 개선 */
  -webkit-tap-highlight-color: transparent;
}

/* 한글 폰트 최적화 - Pretendard 1순위, Noto Sans KR 2순위 */
:lang(ko) {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", "Apple SD Gothic Neo", "Malgun Gothic", 
               -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  word-break: keep-all;
  word-wrap: break-word;
  /* 한글 타이포그래피 최적화 */
  font-feature-settings: "kern" 1;
  letter-spacing: -0.003em;
}

/* 영문 폰트 최적화 - Pretendard 1순위, Noto Sans KR 2순위 */
:lang(en) {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", -apple-system, BlinkMacSystemFont, 
               "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
  /* 영문 타이포그래피 최적화 */
  font-feature-settings: "kern" 1, "liga" 1;
}

/* 모노스페이스 폰트 일관성 */
code, pre, kbd, samp {
  font-family: "SF Mono", Monaco, "Inconsolata", "Roboto Mono", "Source Code Pro", 
               Menlo, "DejaVu Sans Mono", "Courier New", monospace;
}

/* 웹폰트 로딩 최적화 */
.font-loading {
  font-display: swap;
  visibility: hidden;
}

.font-loaded {
  visibility: visible;
}

/* 폰트 로딩 중 fallback 스타일 */
@supports (font-display: swap) {
  .font-loading {
    visibility: visible;
  }
}

/* 브라우저별 폰트 렌더링 일관성 */
input, textarea, select, button {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

/* 특정 브라우저에서 폰트 크기 조정 방지 */
input[type="text"],
input[type="email"],
input[type="password"],
textarea {
  font-size: 16px; /* iOS Safari 줌 방지 */
}

/* 고해상도 디스플레이에서 폰트 최적화 */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 2dppx) {
  html {
    -webkit-font-smoothing: subpixel-antialiased;
  }
}

/* Pretendard Variable 폰트 Weight 유틸리티 */
.font-pretendard-thin { font-variation-settings: "wght" 100; }
.font-pretendard-extralight { font-variation-settings: "wght" 200; }
.font-pretendard-light { font-variation-settings: "wght" 300; }
.font-pretendard-regular { font-variation-settings: "wght" 400; }
.font-pretendard-medium { font-variation-settings: "wght" 500; }
.font-pretendard-semibold { font-variation-settings: "wght" 600; }
.font-pretendard-bold { font-variation-settings: "wght" 700; }
.font-pretendard-extrabold { font-variation-settings: "wght" 800; }
.font-pretendard-black { font-variation-settings: "wght" 900; }

/* 디자인 시스템에 맞는 타이포그래피 스케일 */
.text-pretendard-h1 {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 700;
  font-size: 2.5rem;
  line-height: 1.2;
  letter-spacing: -0.025em;
}

.text-pretendard-h2 {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 600;
  font-size: 2rem;
  line-height: 1.3;
  letter-spacing: -0.02em;
}

.text-pretendard-h3 {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 600;
  font-size: 1.5rem;
  line-height: 1.4;
  letter-spacing: -0.015em;
}

.text-pretendard-body {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 400;
  font-size: 1rem;
  line-height: 1.6;
  letter-spacing: -0.003em;
}

.text-pretendard-small {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 400;
  font-size: 0.875rem;
  line-height: 1.5;
  letter-spacing: 0;
}

.text-pretendard-caption {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 500;
  font-size: 0.75rem;
  line-height: 1.4;
  letter-spacing: 0.025em;
}

/* 디자인 시스템 버튼 타이포그래피 */
.btn-pretendard {
  font-family: "Pretendard Variable", Pretendard, "Noto Sans KR", sans-serif;
  font-variation-settings: "wght" 500;
  letter-spacing: -0.005em;
}

/* Apple Liquid Glass Effect - Figma Style */
.apple-liquid-glass {
  background: linear-gradient(
    135deg,
    rgba(0, 0, 0, 0.4) 0%,
    rgba(0, 0, 0, 0.25) 25%,
    rgba(255, 255, 255, 0.03) 50%,
    rgba(0, 0, 0, 0.2) 75%,
    rgba(0, 0, 0, 0.45) 100%
  );
  backdrop-filter: blur(28px) saturate(150%);
  -webkit-backdrop-filter: blur(28px) saturate(150%);
  border: 1px solid rgba(255, 255, 255, 0.06);
  /* box-shadow: 
    0 20px 50px rgba(0, 0, 0, 0.4),
    inset 0 1px 0 rgba(255, 255, 255, 0.08),
    inset 0 -1px 0 rgba(0, 0, 0, 0.2); */
  border-radius: 18px;
  position: relative;
  overflow: hidden;
}

.apple-liquid-glass::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent 0%,
    rgba(255, 255, 255, 0.15) 25%,
    rgba(255, 255, 255, 0.3) 50%,
    rgba(255, 255, 255, 0.15) 75%,
    transparent 100%
  );
  opacity: 0.6;
}

.apple-liquid-glass::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background:
    radial-gradient(
      circle at 25% 15%,
      rgba(255, 255, 255, 0.08) 0%,
      transparent 30%
    ),
    radial-gradient(
      circle at 75% 85%,
      rgba(255, 255, 255, 0.04) 0%,
      transparent 35%
    ),
    linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.02) 0%,
      transparent 45%,
      rgba(255, 255, 255, 0.01) 100%
    );
  pointer-events: none;
  mix-blend-mode: soft-light;
}

/* 배경 스크롤 방지 - 최소한 설정 */
html,
body {
  overflow: hidden;
  height: 100vh;
  margin: 0;
  padding: 0;
}

body {
  /*background-image: url('./assets/bg_main.png');*/
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  background-attachment: fixed;
  overscroll-behavior: none;
}

button {
  @apply cursor-pointer;
}

a {
  @apply no-underline text-inherit;
}

ul,
ol {
  @apply list-none p-0 m-0;
}

h1,
h2,
h3,
h4,
h5,
h6,
p {
  @apply m-0 p-0 font-normal;
}

img,
video {
  @apply max-w-full h-auto block;
}

/* 커스텀 스크롤바 스타일 */
.custom-scrollbar {
  /* WebKit 기반 브라우저 (Chrome, Safari, Edge) */
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

.custom-scrollbar::-webkit-scrollbar {
  width: 8px;
}

.custom-scrollbar::-webkit-scrollbar-track {
  background: transparent;
}

.custom-scrollbar::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.3);
  border-radius: 4px;
  border: none;
}

.custom-scrollbar::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255, 255, 255, 0.5);
}

/* Firefox */
.custom-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(255, 255, 255, 0.3) transparent;
}

/* 마크다운 스타일링 */
.markdown-content h1 {
  @apply text-2xl font-bold text-white mb-4 mt-6 first:mt-0;
}

.markdown-content h2 {
  @apply text-xl font-semibold text-white mb-3 mt-5 first:mt-0;
}

.markdown-content h3 {
  @apply text-lg font-medium text-white mb-2 mt-4 first:mt-0;
}

.markdown-content p {
  @apply text-white mb-4;
  white-space: pre-wrap;
}

.markdown-content div {
  white-space: pre-wrap;
}

.markdown-content ul {
  @apply text-white space-y-1 mb-3 pl-4 list-disc;
}

.markdown-content ol {
  @apply text-white space-y-1 mb-3 pl-4 list-decimal;
}

.markdown-content li {
  @apply text-white;
}

.markdown-content code {
  @apply bg-white/10 text-white px-1.5 py-0.5 rounded text-sm;
}

.markdown-content pre {
  @apply bg-black/20 rounded-lg p-4 mb-3 overflow-x-auto;
}

.markdown-content pre code {
  @apply bg-transparent p-0 rounded-none;
}

.markdown-content blockquote {
  @apply border-l-4 border-white/30 pl-4 italic text-white/80 mb-3;
}

.markdown-content table {
  @apply min-w-full border-collapse mb-3;
}

.markdown-content thead {
  @apply bg-white/10;
}

.markdown-content tbody {
  @apply bg-white/5;
}

.markdown-content tr {
  @apply border-b border-white/10;
}

.markdown-content th {
  @apply text-white font-semibold px-4 py-2 text-left;
}

.markdown-content td {
  @apply text-white px-4 py-2;
}

.markdown-content a {
  @apply text-blue-300 hover:text-blue-200 underline;
}

.markdown-content hr {
  @apply border-white/20 my-6;
}

.markdown-content strong {
  @apply font-semibold text-white;
}

.markdown-content em {
  @apply italic text-white;
}

/* Menu Item Hover Effect - Glass Style from Figma */
.menu-item-hover {
  @apply relative transition-all duration-200 ease-in-out;
}

/* Layer 1: Base white layer (25% opacity, NORMAL blend) */
.menu-item-hover::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 8px;
  background-color: rgba(255, 255, 255, 0.25);
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  pointer-events: none;
}

/* Layer 2 & 3: Saturation and Linear Dodge effects combined */
.menu-item-hover::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  border-radius: 8px;
  opacity: 0;
  transition: opacity 0.2s ease-in-out;
  pointer-events: none;

  /* Precise glass border with inner/outer glow */
  border: 0.5px solid rgba(255, 255, 255, 0.12);
  box-shadow:
    inset 0.5px 0.5px 1px rgba(255, 255, 255, 0.4),
    inset -0.5px -0.5px 1px rgba(255, 255, 255, 0.08),
    0 0 0 0.5px rgba(255, 255, 255, 0.06);
}

.menu-item-hover:hover::before,
.menu-item-hover:hover::after {
  opacity: 1;
}

/* Menu Glass Background - Ultra transparent glass */
.menu-glass-background {
  position: absolute;
  inset: 0;
  overflow: hidden;
  transition:
    width 0.3s ease-in-out,
    height 0.3s ease-in-out;
  transform-origin: left;
  border-radius: 24px;

  /* Ultra transparent base - no background fill */
  background-color: transparent;

  /* White glass border with gradient strength */
  border: 1px solid rgba(255, 255, 255, 0.08);

  /* Subtle background gradient overlay */
  background-image:
    linear-gradient(
      135deg,
      rgba(255, 255, 255, 0.06) 0%,
      rgba(255, 255, 255, 0.01) 25%,
      transparent 100%
    ),
    linear-gradient(
      315deg,
      rgba(255, 255, 255, 0.04) 0%,
      rgba(255, 255, 255, 0.005) 20%,
      transparent 100%
    );
  background-origin: border-box;
  background-clip: content-box, border-box;

  /* Directional border enhancement - top-left and bottom-right emphasis */
  box-shadow:
    /* Top-left corner highlight */
    inset 1px 1px 0 rgba(255, 255, 255, 0.15),
    /* Bottom-right corner highlight */ inset -1px -1px 0
      rgba(255, 255, 255, 0.1),
    /* Overall subtle glow */ 0 0 0 0.5px rgba(255, 255, 255, 0.03);
}

/* Full menu width variant - 반응형 + 1470px 이하 고정 */
.menu-glass-full {
  width: 280px; /* 1470px 이하에서 280px 고정 */
  height: 100%; /* 부모 높이에 맞춤 */
}

/* Mini menu width variant */
.menu-glass-mini {
  width: 92px;
  height: 100%; /* 부모 높이에 맞춤 */
}

/* CR 모드 HTML 응답 스타일링 */
.cr-html-content {
  color: white;
  line-height: 1.6;
}

.cr-html-content h1,
.cr-html-content h2,
.cr-html-content h3,
.cr-html-content h4,
.cr-html-content h5,
.cr-html-content h6 {
  color: white;
  font-weight: bold;
  margin: 1.5em 0 0.5em 0;
}

.cr-html-content h1 {
  font-size: 1.8em;
  border-bottom: 2px solid rgba(255, 255, 255, 0.3);
  padding-bottom: 0.5em;
}

.cr-html-content h2 {
  font-size: 1.5em;
  border-bottom: 1px solid rgba(255, 255, 255, 0.2);
  padding-bottom: 0.3em;
}

.cr-html-content h3 {
  font-size: 1.3em;
}

.cr-html-content p {
  margin: 1em 0;
  color: rgba(255, 255, 255, 0.9);
}

.cr-html-content ul,
.cr-html-content ol {
  margin: 1em 0;
  padding-left: 2em;
  color: rgba(255, 255, 255, 0.9);
}

.cr-html-content li {
  margin: 0.5em 0;
}

.cr-html-content a {
  color: rgb(139, 192, 255);
  text-decoration: underline;
}

.cr-html-content a:hover {
  color: rgb(159, 212, 255);
}

.cr-html-content strong,
.cr-html-content b {
  color: white;
  font-weight: bold;
}

.cr-html-content em,
.cr-html-content i {
  font-style: italic;
  color: rgba(255, 255, 255, 0.8);
}

.cr-html-content blockquote {
  border-left: 4px solid rgba(255, 255, 255, 0.3);
  padding-left: 1em;
  margin: 1em 0;
  font-style: italic;
  color: rgba(255, 255, 255, 0.8);
}

.cr-html-content code {
  background: rgba(255, 255, 255, 0.1);
  color: white;
  padding: 0.2em 0.4em;
  border-radius: 4px;
  font-family: 'Courier New', monospace;
  font-size: 0.9em;
}

.cr-html-content pre {
  background: rgba(0, 0, 0, 0.3);
  color: white;
  padding: 1em;
  border-radius: 8px;
  overflow-x: auto;
  margin: 1em 0;
}

.cr-html-content pre code {
  background: transparent;
  padding: 0;
}

.cr-html-content table {
  border-collapse: collapse;
  width: 100%;
  margin: 1em 0;
  border: 1px solid rgba(255, 255, 255, 0.2);
}

.cr-html-content th,
.cr-html-content td {
  padding: 0.8em;
  text-align: left;
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: rgba(255, 255, 255, 0.9);
}

.cr-html-content th {
  background: rgba(255, 255, 255, 0.1);
  font-weight: bold;
  color: white;
}

.cr-html-content hr {
  border: none;
  border-top: 1px solid rgba(255, 255, 255, 0.2);
  margin: 2em 0;
}

/* ChatInput 기본 스타일 - 데스크탑은 원래 fixed 방식 */
.chat-input-container {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  z-index: 1000;
  width: clamp(320px, 80vw, 1400px);
  max-width: 1192px;
  min-height: 236px;
  max-height: 800px;
  padding: 32px 40px;
  border-radius: 24px;
}

/* Agent Card Grid - ChatInput 너비에 맞춤 */
.agent-card-grid {
  grid-template-columns: repeat(4, 1fr); /* 4개 카드 균등 분할 */
  width: 100%; /* 부모 컨테이너 전체 너비 사용 */
  gap: 20px !important; /* 1470px 이하에서 고정 간격 - 강제 적용 */
}

/* 레이아웃 CSS 변수 정의 */
:root {
  --sidebar-left: 100px;
  --sidebar-width: 280px;
  --main-left: 450px;
  --main-right: 100px;
  --main-height: 850px;
  --chatinput-height: 236px;
  --chatinput-max-width: 1192px;
  --chatinput-padding: 32px;
}

/* 1030px 초과 1470px 이하에서 고정값 강제 적용 */
@media (min-width: 1031px) and (max-width: 1470px) {
  /* 사이드바 고정 */
  .left-side-menu {
    left: 100px !important;
    max-height: 810px !important;
    width: 280px !important;
  }

  /* 메인 영역 고정 */
  main {
    left: 480px !important;
    right: 0px !important;
    height: 850px !important;
    max-width: 880px !important;
    min-width: 880px !important;
    width: 880px !important;
    transform: translateX(0%) !important;
  }

  /* ChatInput 데스크탑 중간 크기 조정 */
  .chat-input-container {
    max-width: 880px;
    min-width: 880px;
    width: 880px;
    max-height: 650px;
  }

  /* ChatInput 내부 textarea 고정 */
  .chat-input-container textarea {
    max-height: 450px; /* textarea 최대 높이 고정 */
    min-height: 80px;
  }

  /* AgentCard 컨테이너 고정 */
  .agent-card-grid-container {
    max-width: 880px !important;
    min-width: 880px !important;
    width: 880px !important;
  }

  /* AgentCard Wrapper 고정 */
  .agent-cards-wrapper {
    padding-bottom: 286px;
    padding-top: 400px; /* 위쪽에 패딩 추가 */
    align-items: flex-start; /* 위쪽 기준 정렬 */
  }

  /* AgentCard Grid 고정 */
  .agent-card-grid {
    gap: 20px !important;
    max-width: 880px !important;
    min-width: 880px !important;
    width: 880px !important;
    grid-template-columns: repeat(4, 1fr) !important;
  }

  /* AgentCard 개별 고정 */
  .agent-card-grid > *,
  .agent-card {
    width: 211px !important; /* (880px - 20px*3간격) / 4 */
    height: 211px !important;
    min-width: 211px !important;
    max-width: 211px !important;
    min-height: 211px !important;
    max-height: 211px !important;
    flex-shrink: 0 !important;
    flex-grow: 0 !important;
  }
}

/* 브라우저 높이 830px 이하에서 높이 고정 */
@media (max-height: 830px) {
  .left-side-menu {
    height: 650px !important;
    max-height: 650px !important;
  }

  main {
    height: 650px !important;
    max-height: 650px !important;
  }
}

/* 1470px 이상에서만 반응형 변수 적용 */
@media (min-width: 1470px) {
  .agent-card-grid {
    gap: 0.9vw !important; /* 1470px 이상에서만 반응형 간격 - 강제 적용 */
  }

  /* ChatInput 대형 화면 크기 조정 */
  .chat-input-container {
    max-height: 800px;
  }

  /* ChatInput 내부 textarea 반응형 설정 */
  .chat-input-container textarea {
    max-height: 600px; /* textarea 최대 높이 고정 */
    min-height: 80px;
  }
}

/* 모바일 대응 (1030px 이하) */
@media (max-width: 1030px) {
  /* AgentCard Grid 모바일 대응 - 2x2 배치 */
  .agent-card-grid-container {
    max-width: 100% !important;
    min-width: auto !important;
    width: 100% !important;
    padding: 0 20px !important;
  }

  .agent-card-grid {
    grid-template-columns: repeat(2, 1fr) !important; /* 2열 배치 */
    gap: 12px !important;
    max-width: 320px !important; /* 고정 최대 너비로 크기 제한 */
    width: 100% !important;
    margin: 0 auto !important;
  }

  /* AgentCard 모바일 크기 */
  .agent-card-grid > *,
  .agent-card {
    width: 100% !important;
    height: auto !important;
    aspect-ratio: 1 !important; /* 정사각형 비율 유지 */
    min-width: 140px !important; /* 크기 증가 */
    max-width: 160px !important; /* 크기 증가 */
    min-height: 140px !important; /* 크기 증가 */
    max-height: 160px !important; /* 크기 증가 */
  }

  /* 모바일에서 AgentCard 내부 이미지 조정 */
  .agent-card img {
    width: 100% !important;
    height: 100% !important;
    object-fit: cover !important;
  }

  /* AgentCard 컨테이너 패딩 조정 */
  .agent-cards-wrapper {
    /* React에서 동적으로 위치 설정 */
  }

  /* ChatInput 모바일 대응 - Absolute positioning */
  .chat-input-container {
    position: absolute !important;
    bottom: 0 !important;
    left: 0 !important;
    right: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    transform: none !important;
    padding: 16px 20px !important;
    min-height: 160px !important;
    max-height: 350px !important;
    border-radius: 20px 20px 0 0 !important;
    z-index: 1000 !important;
  }

  /* ChatInput 내부 영역 조정 */
  .chat-input-container textarea {
    min-height: 60px;
    max-height: 200px;
    font-size: 16px; /* iOS 확대 방지 */
  }

  /* 채팅 메시지 영역 모바일 대응 */
  .chat-messages-container {
    bottom: 160px; /* ChatInput 높이만큼 조정 */
    left: 0;
    right: 0;
    padding: 0 20px;
  }

  /* ChatHeader 모바일 대응 */
  .chat-header-container {
    left: 10px;
    right: 10px;
    padding: 0 16px;
  }

  /* 모바일에서 스크롤 투 바텀 버튼 위치 조정 */
  .scroll-to-bottom-mobile {
    bottom: 170px;
  }

  /* SourceContainer 모바일 대응 */
  .source-container-mobile {
    width: calc(100vw - 20px);
    right: 10px;
    top: 60px; /* 햄버거 메뉴 버튼 아래 */
    height: calc(100vh - 200px); /* 상단과 하단 여백 */
    border-radius: 16px;
    padding: 20px;
  }

  /* main 영역 모바일 대응 */
  main {
    left: 50%;
    right: auto;
    top: 50%;
    transform: translateX(-50%) translateY(-50%);
    width: calc(100vw - 40px);
    max-width: none;
    min-width: auto;
    height: 100vh;
    max-height: 100vh;
    position: fixed;
  }

  /* 모바일에서 aside(SideMenu) 숨기기 */
  .left-side-menu {
    display: none;
  }
}
